perfspec NetObjPerf€€€import‚AllocSpec.StartAlloc,‚AllocSpec.EndAlloc;€€€timed event‚StartAlloc(€tid,€size);‚EndAlloc(€tid);€€€interval Alloc =„€s: StartAlloc,„€e: EndAlloc†where €€€€€€€€€€s.tid‚= €€€€e.tid‚metrics„size =†€€€€€€€€€€s.size,„tid =†€€€€€€€€€€s.tid‚end Alloc;€€€timed event‚CreatedSurrogate(€wrep1,€wrep2,€wrep3,€wrep4);‚DeletedSurrogate(€wrep1,€wrep2,€wrep3,€wrep4);€€€event‚FoundSurrogate(€);€€€interval SurrogateLifeTime =„€s: CreatedSurrogate,„€e: DeletedSurrogate†where €€€€€€€€€€s.wrep1‚= €€€€e.wrep1‚& €€€€€€s.wrep2‚= €€€€e.wrep2‚& €€€€€€s.wrep3‚= €€€€e.wrep3‚& €€€€€€s.wrep4‚= €€€€e.wrep4‚metrics‚end SurrogateLifeTime;€€€assert‚€€€€€€€€€€{€count cƒ: CreatedSurrogate}‚/ €€{€count cƒ: FoundSurrogate}‚< €€€€0.1;€€€timed event‚StartNewConnection(€tid,€foundFree);‚EndNewConnection(€tid,€OK);€€€interval NewConnection =„€s: StartNewConnection,„€e: EndNewConnection†where €€€€€€€€€€s.tid‚= €€€€e.tid‚metrics„foundFree =†€€€€€€€€€€s.foundFree,„OK =†€€€€€€€€€€e.OK,„sts =†€€€€€€€€€€timestamp(€€€€€€€€€€€s),„tid =†€€€€€€€€€€s.tid,„nAlloc =†€€€€€€€€€€{€count nƒ: Alloc…where €€€€€€€€€€n.tid‚= €€€€s.tid},„bytesAlloc =†€€€€€€€€€€{€+ nƒ: Alloc…where €€€€€€€€€€n.tid‚= €€€€s.tidƒ: €€€€€€€€€€n.size}‚end NewConnection;€€€event‚LocationFromEndpoint(€found);€€€event‚AddFPtoTC(€);€€€def‚€maxNFP =‚€€€€€€€€€€1000;€€€assert‚€€€€€€€€€€{€count aƒ: AddFPtoTC}‚<= €€€€maxNFP;€€€event‚FindFP(€);€€€timed event‚StartCall(€tid,€nargs);‚EndCall(€tid,€argbytes,€resbytes);‚OStartCall(€tid,€nargs);‚OEndCall(€tid,€argbytes,€resbytes);€€€interval NetCall =„€s: StartCall,„€e: EndCall†where €€€€€€€€€€s.tid‚= €€€€e.tid‚metrics„nargs =†€€€€€€€€€€s.nargs,„argbytes =†€€€€€€€€€€e.argbytes,„resbytes =†€€€€€€€€€€e.resbytes,„nAlloc =†€€€€€€€€€€{€count nƒ: Alloc…where €€€€€€€€€€n.tid‚= €€€€s.tid},„bytesAlloc =†€€€€€€€€€€{€+ nƒ: Alloc…where €€€€€€€€€€n.tid‚= €€€€s.tidƒ: €€€€€€€€€€n.size},„sts =†€€€€€€€€€€timestamp(€€€€€€€€€€€s),„surrCreated =†€€€€€€€€€€{€count nƒ: CreatedSurrogate},„surrFound =†€€€€€€€€€€{€count nƒ: FoundSurrogate},„newConnect =†€€€€€€€€€€{€count nƒ: StartNewConnection…where €€€€€€€€€€n.foundFree‚= €€€€0‚& €€€€€€n.tid‚= €€€€s.tid},„timeConnect =†€€€€€€€€€€{€+ nƒ: NewConnection…where €€€€€€€€€€n.tid‚= €€€€s.tidƒ: €€€€€€€€€€elapsed(€€€€€€€€€€€n)}‚end NetCall;€€€interval ONetCall =„€s: OStartCall,„€e: OEndCall†where €€€€€€€€€€s.tid‚= €€€€e.tid‚metrics„nargs =†€€€€€€€€€€s.nargs,„argbytes =†€€€€€€€€€€e.argbytes,„resbytes =†€€€€€€€€€€e.resbytes‚end ONetCall;€€€def‚€MaxElapsed =‚€€€€€€€€€€10 ms;€€€assert‚€€€€€€€€€€{€& iƒ: NetCall…where €€€€€€€€€€i.argbytes‚= €€€€0‚& €€€€€€i.resbytes‚= €€€€0ƒ: €€€€€€€€€€elapsed(€€€€€€€€€€€i)‚<= €€€€MaxElapsed};€€€timed event‚ObjTabLockRequested(€tid);‚ObjTabLockObtained(€tid);€€€interval ObjTabLockWait =„€s: ObjTabLockRequested,„€e: ObjTabLockObtained†where €€€€€€€€€€s.tid‚= €€€€e.tid‚metrics‚end ObjTabLockWait;€€€def‚€OKLongAcquire =‚€€€€€€€€€€0.01;‚€maxLockAcquire =‚€€€€€€€€€€100 us;€€€assert‚€€€€€€€€€€{€count oƒ: ObjTabLockWait…where €€€€€€€€€€elapsed(€€€€€€€€€€€o)‚> €€€€maxLockAcquire}‚/ €€{€count oƒ: ObjTabLockWait}‚< €€€€OKLongAcquire€€endNetObjPerf